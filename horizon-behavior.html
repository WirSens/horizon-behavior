<link rel="import" href="../polymer/polymer.html">

<script>
    WIRSENS = window.WIRSENS || {};

    /* @polymerBehavior */
    WIRSENS.HorizonBehavior = {
        
        properties: {
            
            _horizonHost: {
                type: String,
                value: 'localhost'
            },

            _horizonPort: {
                type: String,
                value: '8181'
            },

            _horizon: {
                type: Object,
                computed: '_computeHorizon(_horizonHost, _horizonPort, _isReady)',
                notify: true
            }
        },

        observers: [
            '_loadLib(_horizonHost, _horizonPort)'
        ],

        _loadLib(host, port) {
            const script = document.createElement('script');
            script.src = `http://${host}:${port}/horizon/horizon.js`;
            Polymer.dom(this.root).appendChild(script);
            
            script.onload = () => {
                this._isReady = true;
            };
        },

        _computeHorizon(host, port) {
            return Horizon({
                host: `${host}:${port}`
            });
        }  
    };
</script>